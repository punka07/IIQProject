<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE TaskDefinition PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<TaskDefinition executor="sailpoint.reporting.LiveReportExecutor" name="COB-TaskDefinition-ReportInactiveIdentities" progressMode="Percentage" resultAction="Rename" subType="Identity and User Reports" template="true" type="LiveReport">
  <Attributes>
    <Map>
      <entry key="report">
        <value>
          <LiveReport title="Report Inactive Identities">
            <DataSource objectType="Link" type="Hql">
              <Query>from Identity identity, Link link where identity.id = link.identity and identity.inactive=1 and link.attributes not like '%IIQDisabled%'</Query>
              <QueryParameters>
                <Parameter argument="applications"/>
              </QueryParameters>
              <QueryScript>
                <Source><![CDATA[  
                              if (args.containsKey("applications")){  
                                return query + " and link.application.id in (:applications)";  
                              }  
                              return query;                            
                       ]]></Source>
              </QueryScript>
            </DataSource>
            <Columns>
              <ReportColumnConfig field="application" header="Application" property="link.application.name" sortable="true" width="110"/>
              <ReportColumnConfig field="nativeIdentity" header="rept_app_account_attrs_col_account" property="link.nativeIdentity" sortable="true" width="110"/>
              <ReportColumnConfig field="displayName" header="Account Display Name" property="link.displayName" sortable="true" width="110"/>
              <ReportColumnConfig field="identityFirstname" header="firstname" property="identity.firstname" sortable="true" width="110"/>
              <ReportColumnConfig field="identityLastname" header="lastname" property="identity.lastname" sortable="true" width="110"/>
              <ReportColumnConfig field="identityEmail" header="email" property="identity.email" sortable="true" width="110"/>
              <ReportColumnConfig field="identityManager" header="manager" property="identity" sortable="true" width="110">
                <RenderScript>
                  <Source><![CDATA[  
              
                if(value.getManager() != null)  
                 return value.getManager().getDisplayName();  
                return "";  
              
          ]]></Source>
                </RenderScript>
              </ReportColumnConfig>
              <ReportColumnConfig field="identityCorrelated" header="Correlated" property="identity.correlated" sortable="true" width="110"/>
            </Columns>
          </LiveReport>
        </value>
      </entry>
    </Map>
  </Attributes>
  <Description>A detailed view of the identities that have inactive accounts</Description>
  <Signature>
    <Inputs>
      <Argument multi="true" name="applications" type="Application">
        <Description>rept_app_status_help_apps</Description>
      </Argument>
    </Inputs>
  </Signature>
</TaskDefinition>
